<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <title>js练习</title>
</head>

<body>
    <script type="text/javascript">
        console.log("练习一对象的深度拷贝")
        console.log("方法一");
        var a = Symbol('bb'); //Symbol数据类型
        var person = {
            name: '吴呜无',
            perfect: {
                one: '1',
                two: '2'
            },
            fun: function() {
                console.log("我是一个函数");
            },
            un: undefined, //undefined数据类型
        }
        var copy = JSON.parse(JSON.stringify(person));
        copy.name = "吴先生"
        console.log(copy);
        console.log(person);
        console.log("这个方法会省略掉  Symbol类型 function undefined");
        console.log("--------------------------------------------------------------")
        console.log("方法二：递归复制")

        function deepCopy(obj) {
            var result = Array.isArray(obj) ? [] : {};//判断是否为数组
            for (var key in obj) {
                if (obj.hasOwnProperty(key)) { //用来判断某个对象是否含有这个属性
                    if (typeof obj[key] === 'object') { //判断是否为object类型
                        result[key] = deepCopy(obj[key]); //递归复制
                    } else {
                        result[key] = obj[key];
                    }
                }
            }
            return result;
        }
        var newObj = deepCopy(person);
        newObj.name = "吴师傅"
        console.log(newObj);
        console.log(person);
        console.log("--------------------------------------------------------------")


        console.log("this的指向问题");
        var x = 11;
        var objThis = {
            x: 22,
            say: function() {
                console.log(this.x);
            },
            say2: () => {
                console.log(this.x);
            }
        };
        console.log(objThis.say(),"Es5 this指向直接调用者");
        console.log(objThis.say2(),"Es6 this在定义时绑定 ，指向window");

        console.log('---------------华丽的分割线----------------------------');
        console.log('排序去重');
        var arrList = [9, 56, 36, 11, 855, 0, 26, 47, 99, 1520, 369, 14475, 29];
        var n_arrList = [];
        for (let i = 0; i < arrList.length; i++) {
            var num = 0;
            for (let j = 0; j < arrList.length; j++) {
                if (arrList[i] > arrList[j]) {
                    num += 1;
                }
            }
            n_arrList[num] = arrList[i];
        }
        console.log(n_arrList);

        function bubbleSort2(arr) {
            console.time('改进后冒泡排序耗时');
            var i = arr.length - 1; //初始时,最后位置保持不变
            while (i > 0) {
                var pos = 0; //每趟开始时,无记录交换
                for (var j = 0; j < i; j++)
                    if (arr[j] > arr[j + 1]) {
                        pos = j; //记录交换的位置
                        var tmp = arr[j];
                        arr[j] = arr[j + 1];
                        arr[j + 1] = tmp;
                    }
                i = pos; //为下一趟排序作准备
            }
            console.timeEnd('改进后冒泡排序耗时');
            return arr;
        }
        var arr = [3, 44, 38, 5, 47, 15, 36, 26, 27, 2, 46, 4, 19, 50, 48];
        console.log(bubbleSort2(arr));

        console.log('---------------华丽的分割线Async(Promise) await----------------------------');

        async function getMenoy(){
            var user = await setA('吴先生');
            var amount = await setB(user);
            return amount;
        }
        getMenoy().then(data=>{
            console.log(data);
        }).catch((err)=>{
            console.log(err);
        });

        function setA(val) {
            return new Promise(resolve => {
                setTimeout(() => {
                    resolve(val)
                },1000);
            })
        };

        function setB(user) {
            return new Promise((resolve,reject) => {
                setTimeout(()=>{
                    if(user === "吴先生"){
                        resolve(user+"存入：1,000元")
                    }else{
                        reject('用户错误')
                    }
                },1000);
            });
        };

        console.log('---------------华丽的分割线ES6--Class----------------------------');
        class Rectangle {
            // constructor
            constructor(height, width) {
                this.height = height;
                this.width = width;
            }
            // Getter
            get area() {
                return this.calcArea()
            }
            // Method
            calcArea() {
                return this.height * this.width;
            }
        }
        const square = new Rectangle(10, 10);

        console.log(square.area);


    </script>
</body>

</html>
